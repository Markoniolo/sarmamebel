{"version":3,"sources":["scripts/modal-login.js"],"names":["modalLogin","document","querySelector","modalLoginInit","goRegistration","title","recoveryLink","phoneValueSpan","codeInputs","querySelectorAll","changeNumberBtn","modalSubmit","loginInput","pasInput","addEventListener","loginNextStep","once","validate","closeModalLogin","closeBtn","click","resetValidateCode","i","removeEventListener","nextInput","value","length","validateCode","input","substring","replace","focus","blur","checkCode","isValid","disabled","isPhone","checkIsPhone","classList","add","innerHTML","sendPhone","loginPrevStep","sendEmail","remove","showLoader","code","console","log","login","password","regex","RegExp","test","closeModal"],"mappings":"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","sourcesContent":["const modalLogin = document.querySelector('.modal-login')\n\nif (modalLogin) modalLoginInit()\n\nfunction modalLoginInit () {\n    const goRegistration = modalLogin.querySelector('[data-element=\"modal-login-go-registration\"]')\n    const title = modalLogin.querySelector('.modal-login__title')\n    const recoveryLink = modalLogin.querySelector('.modal-login__recovery')\n    const phoneValueSpan = modalLogin.querySelector('.modal-login__phone-value')\n    const codeInputs = modalLogin.querySelectorAll('.modal-login__code-input')\n    const changeNumberBtn = modalLogin.querySelector('.modal-login__change-number')\n    const modalSubmit = modalLogin.querySelector('.modal-login__submit')\n    const loginInput = modalLogin.querySelector('.modal-login__input_login')\n    const pasInput = modalLogin.querySelector('.modal-login__input_password')\n\n    modalSubmit.addEventListener('click', loginNextStep, {once: true})\n    loginInput.addEventListener('input', validate)\n    goRegistration.addEventListener('click', closeModalLogin)\n    recoveryLink.addEventListener('click', closeModalLogin)\n\n    function closeModalLogin () {\n        const closeBtn = modalLogin.querySelector('.f-button.is-close-btn')\n        closeBtn.click()\n    }\n\n    function resetValidateCode () {\n        for (let i = 0; i < codeInputs.length; i++) {\n            codeInputs[i].removeEventListener('input', () => nextInput(codeInputs[i],i+1))\n            codeInputs[i].value = ''\n        }\n    }\n\n    function validateCode () {\n        for (let i = 0; i < codeInputs.length; i++) {\n            codeInputs[i].addEventListener('input', () => nextInput(codeInputs[i],i+1))\n        }\n    }\n\n    function nextInput (input, i) {\n        input.value = input.value.substring(0, 1)\n        input.value = input.value.replace(/[^0-9]/g,'');\n        if (codeInputs[i]) {\n            codeInputs[i].focus()\n        } else {\n            codeInputs[i-1].blur()\n        }\n        checkCode()\n    }\n\n    function checkCode () {\n        let isValid = true\n        for (let i = 0; i < codeInputs.length; i++) {\n            if (!codeInputs[i].value) isValid = false\n        }\n        modalSubmit.disabled = !isValid\n    }\n\n    function loginNextStep () {\n        const isPhone = checkIsPhone()\n        if (isPhone) {\n            modalLogin.classList.add('modal-login_phone')\n            modalSubmit.disabled = true\n            modalSubmit.innerHTML = 'Войти'\n            phoneValueSpan.innerHTML = loginInput.value\n            modalSubmit.addEventListener('click', sendPhone, {once: true})\n            changeNumberBtn.addEventListener('click', loginPrevStep, {once: true})\n            codeInputs[0].focus()\n            validateCode()\n        } else {\n            modalLogin.classList.add('modal-login_email')\n            modalSubmit.innerHTML = 'Войти'\n            modalSubmit.disabled = true\n            pasInput.addEventListener('input', validate)\n            modalSubmit.addEventListener('click', sendEmail, {once: true})\n        }\n    }\n\n    function loginPrevStep () {\n        modalSubmit.removeEventListener('click', sendPhone, {once: true})\n        modalLogin.classList.remove('modal-login_phone')\n        modalSubmit.disabled = true\n        modalSubmit.addEventListener('click', loginNextStep, {once: true})\n        resetValidateCode()\n    }\n\n    function sendPhone () {\n        showLoader()\n        let code = ''\n        for (let i = 0; i < codeInputs.length; i++) {\n            code = code + codeInputs[i].value\n        }\n        console.log({\n            login: loginInput.value,\n            code: code\n        })\n    }\n\n    function sendEmail () {\n        showLoader()\n        console.log({\n            login: loginInput.value,\n            password: pasInput.value\n        })\n    }\n\n    function showLoader () {\n        modalSubmit.disabled = true\n        title.innerHTML = 'Ещё пару секунд'\n        modalLogin.classList.add('modal-login_loader')\n    }\n\n    function checkIsPhone () {\n        const regex = new RegExp('^((8|\\\\+7)[\\\\- ]?)?(\\\\(?\\\\d{3}\\\\)?[\\\\- ]?)?[\\\\d\\\\- ]{7,10}$')\n        return regex.test(loginInput.value)\n    }\n\n    function closeModal () {\n        modalLogin.classList.remove('modal-login_phone')\n        modalLogin.classList.remove('modal-login_email')\n    }\n\n    function validate () {\n        if (this.value) {\n            modalSubmit.disabled = false\n        } else {\n            modalSubmit.disabled = true\n        }\n    }\n}\n"],"file":"modal-login.js"}