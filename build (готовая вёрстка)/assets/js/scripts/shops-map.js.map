{"version":3,"sources":["scripts/shops-map.js"],"names":["shopsMap","document","querySelector","shopsMapInit","myMap","MyIconContentLayout","select","selectComp","getElementsByTagName","addEventListener","toggleList","shopsBox","shopsTop","shopsItems","querySelectorAll","shopsAboutBackArray","i","length","closeShopsAbout","shopsCloses","closeShopsBox","classList","add","resetBox","aboutActive","remove","list","items","openShopsAbout","centerCoords","JSON","parse","getAttribute","setCenter","getCoordsWithDelta","duration","inner","closest","about","shopsLists","geoObjects","removeAll","oldActiveList","index","value","createPlacemark","newFirstItem","body","clientWidth","loadMap","mapScript","createElement","src","appendChild","ymaps","ready","contactMapInit","zoom","Map","center","controls","balloonPanelMaxMapArea","autoFitToViewport","suppressMapOpenBlock","templateLayoutFactory","createClass","activeList","createCurrentPlacemark","item","coords","isPlacemarkOrange","placemark","Placemark","iconContent","iconLayout","iconImageHref","iconImageSize","iconImageOffset","iconContentLayout","properties","set","events","choseActiveItem","e","get","click"],"mappings":"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","sourcesContent":["const shopsMap = document.querySelector('[data-element=\"shops-map\"]')\n\nif (shopsMap) shopsMapInit()\n\nfunction shopsMapInit () {\n    let myMap\n    let MyIconContentLayout\n    let select\n\n    const selectComp = document.querySelector('.custom-select_shops')\n    if (selectComp) {\n        select = selectComp.getElementsByTagName('select')[0]\n        select.addEventListener('change', toggleList)\n    }\n\n    const shopsBox = document.querySelector('[data-element=\"shops-box\"]')\n    const shopsTop = document.querySelector('[data-element=\"shops-top\"]')\n    const shopsItems = document.querySelectorAll('[data-element=\"shops-item\"]')\n    const shopsAboutBackArray = document.querySelectorAll('[data-element=\"shops-about-back\"]')\n\n    for (let i = 0; i < shopsAboutBackArray.length; i++) {\n        shopsAboutBackArray[i].addEventListener('click', closeShopsAbout)\n    }\n\n    const shopsCloses = document.querySelectorAll('[data-element=\"shops-close\"]')\n\n    for (let i = 0; i < shopsCloses.length; i++) {\n        shopsCloses[i].addEventListener('click', closeShopsBox)\n    }\n\n    function closeShopsBox () {\n        shopsBox.classList.add('shops__box_hide')\n        resetBox()\n    }\n\n    function resetBox () {\n        const aboutActive = document.querySelector('.shops__about_active')\n        if (aboutActive) aboutActive.classList.remove('shops__about_active')\n        shopsTop.classList.remove('shops__top_hide')\n        const list = document.querySelector('.shops__list_active')\n        const items = list.querySelectorAll('.shops__item')\n        for (let i = 0; i < items.length; i++) {\n            items[i].classList.remove('shops__item_hide')\n        }\n    }\n\n    for (let i = 0; i < shopsItems.length; i++) {\n        shopsItems[i].addEventListener('click', openShopsAbout)\n    }\n\n    function openShopsAbout () {\n        const centerCoords = JSON.parse(this.getAttribute('data-coords'))\n        myMap.setCenter(getCoordsWithDelta(centerCoords), 14, {duration: 500})\n        const inner = this.closest('.shops__inner')\n        const about = inner.querySelector('.shops__about')\n        const list = this.closest('.shops__list')\n        const items = list.querySelectorAll('.shops__item')\n        for (let i = 0; i < items.length; i++) {\n            items[i].classList.add('shops__item_hide')\n        }\n        shopsTop.classList.add('shops__top_hide')\n        about.classList.add('shops__about_active')\n    }\n\n    function closeShopsAbout () {\n        const about = this.closest('.shops__about')\n        about.classList.remove('shops__about_active')\n        shopsTop.classList.remove('shops__top_hide')\n        const list = this.closest('.shops__list')\n        const items = list.querySelectorAll('.shops__item')\n        for (let i = 0; i < items.length; i++) {\n            items[i].classList.remove('shops__item_hide')\n        }\n    }\n\n    const shopsLists = document.querySelectorAll('[data-element=\"shops-list\"]')\n\n    function toggleList() {\n        myMap.geoObjects.removeAll()\n        const oldActiveList = document.querySelector('.shops__list_active')\n        if (oldActiveList) oldActiveList.classList.remove('shops__list_active')\n        const index = select.value\n        shopsLists[index].classList.add('shops__list_active')\n        createPlacemark(shopsLists[index])\n        const newFirstItem = shopsLists[index].querySelector('.shops__item')\n        const centerCoords = JSON.parse(newFirstItem.getAttribute('data-coords'))\n        myMap.setCenter(getCoordsWithDelta(centerCoords), 14, {duration: 500})\n    }\n\n    function getCoordsWithDelta(centerCoords) {\n        if (document.body.clientWidth < 1260) {\n            centerCoords[0] = centerCoords[0] - 0.012\n        } else {\n            centerCoords[1] = centerCoords[1] - 0.015\n        }\n        return centerCoords\n    }\n\n    loadMap()\n\n    function loadMap () {\n        const mapScript = document.createElement('script')\n\n        mapScript.src = 'https://api-maps.yandex.ru/2.1/?lang=ru_RU'\n        document.body.appendChild(mapScript)\n\n        mapScript.addEventListener('load', function () {\n            ymaps.ready(contactMapInit)\n        })\n    }\n\n    function contactMapInit () {\n        const zoom = 14\n        let centerCoords = JSON.parse(shopsMap.getAttribute('data-coords'))\n        centerCoords = getCoordsWithDelta(centerCoords)\n        myMap = new ymaps.Map('shops__map', {\n            center: centerCoords,\n            zoom: zoom, controls: []\n        }, {balloonPanelMaxMapArea: 0, autoFitToViewport: 'always', suppressMapOpenBlock: true})\n\n        MyIconContentLayout = ymaps.templateLayoutFactory.createClass(\n            '<div class=\"placemark-caption\">$[properties.iconContent]</div>'\n        )\n\n        const activeList = document.querySelector('.shops__list_active')\n        createPlacemark(activeList)\n    }\n\n    function createPlacemark (list) {\n        const items = list.querySelectorAll('[data-element=\"shops-item\"]')\n        for (let i = 0; i < items.length; i++) {\n            createCurrentPlacemark(items[i], i)\n        }\n        function createCurrentPlacemark (item, index) {\n            const coords = JSON.parse(item.getAttribute('data-coords'))\n            const isPlacemarkOrange = item.getAttribute('data-placemark')\n            const placemark = new ymaps.Placemark(coords, {\n                iconContent: ''\n            }, {\n                iconLayout: 'default#imageWithContent',\n                iconImageHref: isPlacemarkOrange ? 'assets/img/placemark_orange.svg' : 'assets/img/placemark_blue.svg',\n                iconImageSize: [48, 48],\n                iconImageOffset: [-24, -24],\n                iconContentLayout: MyIconContentLayout\n            })\n            placemark.properties.set('index', index)\n            myMap.geoObjects.add(placemark)\n            placemark.events.add('click', choseActiveItem)\n        }\n    }\n\n    function choseActiveItem (e) {\n        resetBox()\n        const placemark = e.get('target')\n        const index = placemark.properties.get('index', 0)\n        const list = document.querySelector('.shops__list_active')\n        const items = list.querySelectorAll('.shops__item')\n        items[index].click()\n        const shopsBox = document.querySelector('[data-element=\"shops-box\"]')\n        shopsBox.classList.remove('shops__box_hide')\n    }\n}\n"],"file":"shops-map.js"}